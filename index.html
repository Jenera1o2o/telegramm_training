<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–î–Ω–µ–≤–Ω–∏–∫ –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- Material Symbols Outlined -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            color: #1e293b;
            min-height: 100vh;
            padding: 0;
            font-size: 14px;
            overflow-x: hidden;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            background: #ffffff;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        /* Material Icons —Å—Ç–∏–ª–∏ */
        .material-symbols-outlined {
            font-family: 'Material Symbols Outlined';
            font-weight: normal;
            font-style: normal;
            font-size: 20px;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            display: inline-block;
            white-space: nowrap;
            word-wrap: normal;
            direction: ltr;
            vertical-align: middle;
        }

        .icon {
            color: #059669;
            font-size: 18px;
            vertical-align: middle;
            margin-right: 6px;
        }

        .icon-only {
            color: inherit;
            font-size: 18px;
            vertical-align: middle;
            margin: 0;
        }

        /* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
        .header {
            background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
            padding: 12px 16px;
            color: white;
        }

        .header-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 2px;
            display: flex;
            align-items: center;
        }

        .header-title .icon {
            color: white;
            margin-right: 8px;
            font-size: 20px;
        }

        .header-subtitle {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 6px;
        }

        .header-date {
            background: rgba(255, 255, 255, 0.25);
            display: inline-block;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 11px;
        }

        /* –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-compact {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            padding: 10px;
            background: #f8fafc;
        }

        .stat-mini {
            background: #ffffff;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 18px;
            font-weight: bold;
            color: #059669;
            margin-bottom: 2px;
        }

        .stat-label {
            font-size: 10px;
            color: #64748b;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .main-content {
            padding: 12px;
            padding-bottom: 70px;
        }

        /* –ì–æ–ª–æ—Å–æ–≤–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ */
        .voice-hint {
            background: #f0fdf4;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 3px solid #059669;
            font-size: 12px;
            color: #047857;
        }

        .voice-hint-title {
            font-weight: 600;
            margin-bottom: 6px;
            color: #065f46;
            display: flex;
            align-items: center;
        }

        .voice-hint-title .icon {
            color: #059669;
            margin-right: 6px;
            animation: pulse-voice 2s infinite;
        }

        @keyframes pulse-voice {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .voice-status {
            background: rgba(5, 150, 105, 0.1);
            padding: 8px 12px;
            border-radius: 6px;
            margin-top: 8px;
            font-size: 11px;
            color: #047857;
            display: none;
        }

        .voice-status.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –î–Ω–µ–≤–Ω–∏–∫ */
        .workout-diary {
            background: #ffffff;
            border-radius: 10px;
            padding: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-bottom: 12px;
        }

        .diary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .diary-title {
            font-size: 15px;
            font-weight: 600;
            color: #1e293b;
            display: flex;
            align-items: center;
        }

        .diary-title .icon {
            color: #059669;
            margin-right: 6px;
        }

        .workout-timer {
            display: none;
            align-items: center;
            gap: 6px;
            background: #dcfce7;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 13px;
            font-weight: 600;
            color: #059669;
        }

        .workout-timer.active {
            display: flex;
        }

        .timer-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #059669;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.8); }
        }

        /* –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ */
        .exercise-item {
            background: #f8fafc;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 3px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .exercise-item.active {
            border-left-color: #059669;
            background: #f0fdf4;
        }

        .exercise-item.new-added {
            animation: slideInRight 0.5s ease;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .exercise-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .exercise-name {
            font-size: 14px;
            font-weight: 600;
            color: #1e293b;
            flex: 1;
        }

        .exercise-controls {
            display: flex;
            gap: 6px;
        }

        .control-btn {
            width: 26px;
            height: 26px;
            border-radius: 6px;
            border: 1px solid #cbd5e1;
            background: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        .control-btn.add {
            color: #059669;
            border-color: #059669;
        }

        .control-btn.delete {
            color: #dc2626;
            border-color: #dc2626;
        }

        .control-btn .icon-only {
            font-size: 16px;
        }

        /* –ü–æ–¥—Ö–æ–¥—ã */
        .sets-header {
            display: grid;
            grid-template-columns: 28px 1fr 1fr 30px;
            gap: 8px;
            padding: 6px 0;
            font-size: 11px;
            font-weight: 600;
            color: #64748b;
            text-align: center;
        }

        .set-row {
            display: grid;
            grid-template-columns: 28px 1fr 1fr 30px;
            gap: 8px;
            align-items: center;
            padding: 6px 0;
        }

        .set-number {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #059669;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            margin: 0 auto;
        }

        .set-input {
            padding: 6px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            text-align: center;
            font-size: 13px;
            background: #ffffff;
            width: 100%;
        }

        .set-input:focus {
            outline: none;
            border-color: #059669;
            box-shadow: 0 0 0 2px rgba(5, 150, 105, 0.1);
        }

        .check-circle {
            width: 22px;
            height: 22px;
            border: 2px solid #cbd5e1;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }

        .check-circle.checked {
            background: #10b981;
            border-color: #10b981;
        }

        .check-circle.checked::after {
            content: '‚úì';
            color: white;
            font-size: 11px;
            font-weight: bold;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            border: none;
            padding: 11px 16px;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 6px rgba(5, 150, 105, 0.3);
            width: 100%;
            margin-top: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            background: #ffffff;
            color: #475569;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            box-shadow: 0 2px 6px rgba(220, 38, 38, 0.3);
        }

        .btn-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }

        .btn .icon-only {
            font-size: 16px;
            color: inherit;
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å */
        .workout-progress {
            margin-top: 12px;
            display: none;
        }

        .workout-progress.active {
            display: block;
        }

        .progress-text {
            font-size: 11px;
            color: #64748b;
            margin-bottom: 6px;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 5px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            border-radius: 3px;
            transition: width 0.3s;
            width: 0%;
        }

        /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #ffffff;
            border-top: 1px solid #e2e8f0;
            padding: 6px 0;
            display: flex;
            justify-content: space-around;
            z-index: 100;
            max-width: 600px;
            margin: 0 auto;
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 6px 4px;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
            font-size: 10px;
            color: #64748b;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .nav-item.active {
            color: #059669;
            background: rgba(5, 150, 105, 0.1);
        }

        .nav-item .icon-only {
            font-size: 18px;
        }

        /* –ö–∞–ª–µ–Ω–¥–∞—Ä—å */
        .calendar-container {
            padding: 12px;
            padding-bottom: 70px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .month-nav {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .month-btn {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            background: #ffffff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            background: #f8fafc;
            min-height: 40px;
            position: relative;
        }

        .calendar-day.header {
            font-weight: 600;
            color: #64748b;
            background: transparent;
            cursor: default;
            font-size: 11px;
        }

        .calendar-day.today {
            background: #059669;
            color: white;
            font-weight: 600;
        }

        .calendar-day.has-workout {
            background: #dcfce7;
            border: 2px solid #10b981;
        }

        .calendar-day.has-workout::after {
            content: '';
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
        }

        .calendar-day:active:not(.header) {
            transform: scale(0.95);
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #ffffff;
            padding: 20px;
            border-radius: 12px;
            width: 100%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .modal-title {
            font-size: 16px;
            font-weight: 700;
            color: #1e293b;
        }

        .close-btn {
            background: #f1f5f9;
            border: none;
            font-size: 16px;
            color: #64748b;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 6px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-group {
            margin-bottom: 14px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #334155;
            font-size: 12px;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 9px 10px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            background: #ffffff;
            color: #1e293b;
            font-size: 13px;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #059669;
            box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.1);
        }

        .template-list {
            display: grid;
            gap: 8px;
        }

        .template-item {
            background: #f8fafc;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.2s;
        }

        .template-item:active {
            transform: scale(0.98);
        }

        .template-item.custom {
            border-color: #fbbf24;
            background: #fef3c7;
        }

        .template-name {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 4px;
            font-size: 13px;
            display: flex;
            align-items: center;
        }

        .template-name .icon {
            margin-right: 6px;
            font-size: 16px;
        }

        .template-exercises {
            font-size: 11px;
            color: #64748b;
        }

        .empty-state {
            text-align: center;
            padding: 30px 20px;
            color: #94a3b8;
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 12px;
            opacity: 0.5;
            color: #94a3b8;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ffffff;
            color: #1e293b;
            padding: 10px 14px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1001;
            border-left: 3px solid #10b981;
            max-width: 280px;
            font-size: 12px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        /* –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤ */
        .custom-templates {
            margin-top: 12px;
        }

        .custom-template-header {
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        @media (max-width: 400px) {
            .set-row {
                grid-template-columns: 24px 1fr 1fr 28px;
                gap: 6px;
            }

            .calendar-day {
                min-height: 36px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="header">
            <div class="header-title">
                <span class="material-symbols-outlined icon">fitness_center</span>
                –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
            </div>
            <div class="header-subtitle">–¢–≤–æ–π –ø—É—Ç—å –∫ –∏–¥–µ–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ</div>
            <div class="header-date" id="currentDate"></div>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="stats-compact">
            <div class="stat-mini">
                <div class="stat-number" id="totalWorkouts">0</div>
                <div class="stat-label">–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
            </div>
            <div class="stat-mini">
                <div class="stat-number" id="thisWeekWorkouts">0</div>
                <div class="stat-label">–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ</div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content" id="mainContent">
            <div class="voice-hint">
                <div class="voice-hint-title">
                    <span class="material-symbols-outlined icon">mic</span>
                    –ì–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ
                </div>
                <div>–ì–æ–≤–æ—Ä–∏—Ç–µ –≤ Telegram: "–∂–∏–º –ª–µ–∂–∞ 80 –∫–≥ 10 —Ä–∞–∑" –∏–ª–∏ "–¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è 90 –∫–∏–ª–æ 8 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π"</div>
                <div class="voice-status" id="voiceStatus">
                    –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã...
                </div>
            </div>

            <div class="workout-diary">
                <div class="diary-header">
                    <div class="diary-title">
                        <span class="material-symbols-outlined icon">menu_book</span>
                        –î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
                    </div>
                    <div class="workout-timer" id="workoutTimer">
                        <div class="timer-dot"></div>
                        <span id="timerDisplay">00:00</span>
                    </div>
                </div>

                <div id="exercisesList">
                    <div class="empty-state">
                        <div class="empty-icon">
                            <span class="material-symbols-outlined">edit_note</span>
                        </div>
                        <div style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #475569;">
                            –ù–∞—á–Ω–∏—Ç–µ –Ω–æ–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
                        </div>
                        <div style="font-size: 12px; color: #64748b;">
                            –î–æ–±–∞–≤—å—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≥–æ–ª–æ—Å–æ–º –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏
                        </div>
                    </div>
                </div>

                <div class="btn-grid">
                    <button class="btn btn-secondary" onclick="showAddExercise()">
                        <span class="material-symbols-outlined icon-only">add</span>
                        –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
                    </button>
                    <button class="btn btn-secondary" onclick="showTemplates()">
                        <span class="material-symbols-outlined icon-only">list</span>
                        –®–∞–±–ª–æ–Ω—ã
                    </button>
                </div>

                <button class="btn" id="startBtn" onclick="toggleWorkout()">
                    <span class="material-symbols-outlined icon-only">play_arrow</span>
                    –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
                </button>

                <div class="workout-progress" id="workoutProgress">
                    <div class="progress-text" id="progressText">–ì–æ—Ç–æ–≤ –∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
        <div class="calendar-container" id="calendarContent" style="display: none;">
            <div class="calendar-header">
                <h2 style="font-size: 16px; font-weight: 600;">–ö–∞–ª–µ–Ω–¥–∞—Ä—å</h2>
                <div class="month-nav">
                    <button class="month-btn" onclick="changeMonth(-1)">
                        <span class="material-symbols-outlined">chevron_left</span>
                    </button>
                    <span id="currentMonth" style="font-size: 14px; font-weight: 600;"></span>
                    <button class="month-btn" onclick="changeMonth(1)">
                        <span class="material-symbols-outlined">chevron_right</span>
                    </button>
                </div>
            </div>
            <div class="calendar" id="calendar"></div>
        </div>

        <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å -->
        <div class="main-content" id="progressContent" style="display: none;">
            <h2 style="font-size: 16px; font-weight: 600; margin-bottom: 12px;">–ü—Ä–æ–≥—Ä–µ—Å—Å</h2>
            <div id="progressStats"></div>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchView('main')">
            <span class="material-symbols-outlined icon-only">home</span>
            <div>–ì–ª–∞–≤–Ω–∞—è</div>
        </div>
        <div class="nav-item" onclick="switchView('calendar')">
            <span class="material-symbols-outlined icon-only">calendar_month</span>
            <div>–ö–∞–ª–µ–Ω–¥–∞—Ä—å</div>
        </div>
        <div class="nav-item" onclick="switchView('progress')">
            <span class="material-symbols-outlined icon-only">trending_up</span>
            <div>–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è -->
    <div id="addExerciseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</div>
                <button class="close-btn" onclick="closeModal('addExerciseModal')">&times;</button>
            </div>

            <div class="form-group">
                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</label>
                <input type="text" id="exerciseName" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div class="form-group">
                    <label class="form-label">–ü–æ–¥—Ö–æ–¥—ã</label>
                    <input type="number" id="exerciseSets" class="form-input" value="3" min="1">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</label>
                    <input type="number" id="exerciseReps" class="form-input" value="10" min="1">
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">–í–µ—Å (–∫–≥)</label>
                <input type="number" id="exerciseWeight" class="form-input" value="20" min="0" step="0.5">
            </div>

            <button class="btn" onclick="addExercise()">
                <span class="material-symbols-outlined icon-only">check</span>
                –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
            </button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —à–∞–±–ª–æ–Ω–æ–≤ -->
    <div id="templatesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–®–∞–±–ª–æ–Ω—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
                <button class="close-btn" onclick="closeModal('templatesModal')">&times;</button>
            </div>

            <div class="template-list" id="templatesList"></div>

            <div class="custom-templates">
                <div class="custom-template-header">
                    <span>–ú–æ–∏ —à–∞–±–ª–æ–Ω—ã</span>
                    <button class="btn btn-secondary" onclick="showSaveTemplate()" style="padding: 6px 12px; font-size: 11px; margin: 0;">
                        <span class="material-symbols-outlined icon-only">save</span>
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é
                    </button>
                </div>
                <div id="customTemplatesList"></div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–∞ -->
    <div id="saveTemplateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω</div>
                <button class="close-btn" onclick="closeModal('saveTemplateModal')">&times;</button>
            </div>

            <div class="form-group">
                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞</label>
                <input type="text" id="templateName" class="form-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ—è –ø—Ä–æ–≥—Ä–∞–º–º–∞">
            </div>

            <button class="btn" onclick="saveCustomTemplate()">
                <span class="material-symbols-outlined icon-only">save</span>
                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω
            </button>
        </div>
    </div>

    <script>
        // Telegram Web App –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        let tg = window.Telegram?.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
            tg.disableVerticalSwipes();

            // –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const user = tg.initDataUnsafe?.user;
            if (user) {
                document.getElementById('userName').textContent = user.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            }

            // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º—É –æ–∫–Ω—É –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
            tg.MainButton.setText("–û—Ç–∫—Ä—ã—Ç—å –≤ Telegram");
            tg.MainButton.show();

            // –£–≤–µ–¥–æ–º–∏—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—è –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –ø–æ–ª—É—á–µ–Ω–∏—é –∫–æ–º–∞–Ω–¥
            if (window.parent) {
                window.parent.postMessage({
                    type: 'webapp_ready',
                    webapp_url: window.location.href
                }, '*');
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let exercises = [];
        let isWorkoutActive = false;
        let workoutStartTime = null;
        let timerInterval = null;
        let currentView = 'main';
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let workoutHistory = JSON.parse(localStorage.getItem('workoutHistory') || '{}');
        let customTemplates = JSON.parse(localStorage.getItem('customTemplates') || '[]');

        // –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
        const defaultTemplates = [
            {
                id: 'push',
                name: '–ì—Ä—É–¥—å –∏ —Ç—Ä–∏—Ü–µ–ø—Å',
                icon: 'fitness_center',
                exercises: [
                    {name: '–ñ–∏–º –ª—ë–∂–∞', weight: 80, reps: 10, sets: 4},
                    {name: '–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π', weight: 35, reps: 12, sets: 3},
                    {name: '–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π –∂–∏–º', weight: 25, reps: 15, sets: 3}
                ]
            },
            {
                id: 'pull',
                name: '–°–ø–∏–Ω–∞ –∏ –±–∏—Ü–µ–ø—Å',
                icon: 'back_hand',
                exercises: [
                    {name: '–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è', weight: 0, reps: 8, sets: 4},
                    {name: '–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏', weight: 70, reps: 10, sets: 4},
                    {name: '–ü–æ–¥—ä—ë–º –Ω–∞ –±–∏—Ü–µ–ø—Å', weight: 20, reps: 12, sets: 3}
                ]
            },
            {
                id: 'legs',
                name: '–ù–æ–≥–∏',
                icon: 'directions_walk',
                exercises: [
                    {name: '–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è', weight: 90, reps: 10, sets: 4},
                    {name: '–ñ–∏–º –Ω–æ–≥–∞–º–∏', weight: 180, reps: 12, sets: 3},
                    {name: '–í—ã–ø–∞–¥—ã', weight: 40, reps: 12, sets: 3}
                ]
            }
        ];

        // –ü–∞—Ä—Å–µ—Ä –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥
        class VoiceCommandParser {
            constructor() {
                this.exercisePatterns = [
                    // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
                    /(?:–¥–æ–±–∞–≤–∏—Ç—å\s+)?([–∞-—è—ë\s]+?)\s+(\d+(?:[,.]\d+)?)\s*(?:–∫–≥|–∫|–∫–∏–ª–æ|–∫–∏–ª–æ–≥—Ä–∞–º–º)\s+(\d+)\s*(?:—Ä–∞–∑|–ø–æ–≤—Ç–æ—Ä|–ø–æ–≤—Ç–æ—Ä–µ–Ω)/i,
                    /(?:–¥–æ–±–∞–≤–∏—Ç—å\s+)?([–∞-—è—ë\s]+?)\s+(\d+)\s*(?:—Ä–∞–∑|–ø–æ–≤—Ç–æ—Ä|–ø–æ–≤—Ç–æ—Ä–µ–Ω)\s+(\d+(?:[,.]\d+)?)\s*(?:–∫–≥|–∫|–∫–∏–ª–æ|–∫–∏–ª–æ–≥—Ä–∞–º–º)/i,
                    /([–∞-—è—ë\s]+?)\s+(\d+(?:[,.]\d+)?)\s*(?:–∫–≥|–∫|–∫–∏–ª–æ|–∫–∏–ª–æ–≥—Ä–∞–º–º)\s*√ó?\s*(\d+)/i,
                    /([–∞-—è—ë\s]+?)\s+(\d+)\s*√ó?\s*(\d+(?:[,.]\d+)?)\s*(?:–∫–≥|–∫|–∫–∏–ª–æ|–∫–∏–ª–æ–≥—Ä–∞–º–º)/i,
                    // –ë–µ–∑ –≤–µ—Å–∞
                    /(?:–¥–æ–±–∞–≤–∏—Ç—å\s+)?([–∞-—è—ë\s]+?)\s+(\d+)\s*(?:—Ä–∞–∑|–ø–æ–≤—Ç–æ—Ä|–ø–æ–≤—Ç–æ—Ä–µ–Ω)/i,
                    // –ü—Ä–æ—Å—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
                    /([–∞-—è—ë\s]{3,})/i
                ];
            }

            parse(text) {
                if (!text) return null;

                console.log('–ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–º–∞–Ω–¥—ã:', text);

                // –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
                const cleanText = text.toLowerCase()
                    .replace(/[.,!?;:]/g, ' ')
                    .replace(/\s+/g, ' ')
                    .trim();

                for (const pattern of this.exercisePatterns) {
                    const match = cleanText.match(pattern);
                    if (match) {
                        const result = this.extractExerciseData(match);
                        if (result) {
                            console.log('–†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ:', result);
                            return result;
                        }
                    }
                }

                // –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞–π—Ç–∏ —Ö–æ—Ç—è –±—ã –Ω–∞–∑–≤–∞–Ω–∏–µ
                const words = cleanText.split(' ').filter(w => w.length > 2);
                if (words.length > 0) {
                    const name = words.join(' ');
                    if (this.isValidExerciseName(name)) {
                        return {
                            name: this.normalizeExerciseName(name),
                            weight: 20,
                            reps: 10,
                            sets: 3
                        };
                    }
                }

                return null;
            }

            extractExerciseData(match) {
                let name, weight, reps, sets = 3;

                if (match.length >= 4) {
                    // –ü–æ–ª–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å –≤–µ—Å–æ–º –∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏
                    name = match[1];
                    const num1 = parseFloat(match[2].replace(',', '.'));
                    const num2 = parseFloat(match[3].replace(',', '.'));

                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —á—Ç–æ –µ—Å—Ç—å —á—Ç–æ (–≤–µ—Å –æ–±—ã—á–Ω–æ –±–æ–ª—å—à–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π)
                    if (num1 > num2) {
                        weight = num1;
                        reps = num2;
                    } else {
                        weight = num2;
                        reps = num1;
                    }
                } else if (match.length >= 3) {
                    // –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ —Å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è–º–∏ –±–µ–∑ –≤–µ—Å–∞
                    name = match[1];
                    weight = 0;
                    reps = parseInt(match[2]);
                } else {
                    // –¢–æ–ª—å–∫–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
                    name = match[1];
                    weight = 20;
                    reps = 10;
                }

                name = this.normalizeExerciseName(name);

                if (!this.isValidExerciseName(name)) {
                    return null;
                }

                return {
                    name,
                    weight: Math.max(0, weight || 0),
                    reps: Math.max(1, reps || 10),
                    sets: Math.max(1, sets)
                };
            }

            normalizeExerciseName(name) {
                return name.trim()
                    .replace(/\s+/g, ' ')
                    .replace(/^(–¥–æ–±–∞–≤–∏—Ç—å|—Å–¥–µ–ª–∞—Ç—å|–≤—ã–ø–æ–ª–Ω–∏—Ç—å)\s+/i, '')
                    .split(' ')
                    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                    .join(' ');
            }

            isValidExerciseName(name) {
                if (!name || name.length < 3) return false;

                // –°–ø–∏—Å–æ–∫ —Å—Ç–æ–ø-—Å–ª–æ–≤
                const stopWords = ['–¥–æ–±–∞–≤–∏—Ç—å', '—Å–¥–µ–ª–∞—Ç—å', '–≤—ã–ø–æ–ª–Ω–∏—Ç—å', '–Ω–∞—á–∞—Ç—å', '–∫–≥', '—Ä–∞–∑', '–ø–æ–≤—Ç–æ—Ä'];
                const words = name.toLowerCase().split(' ');

                return !words.every(word => stopWords.includes(word)) && 
                       words.some(word => word.length > 2);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–∞
        const voiceParser = new VoiceCommandParser();

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        window.addEventListener('message', function(event) {
            console.log('–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ:', event.data);

            if (event.data && event.data.type) {
                switch(event.data.type) {
                    case 'voice_command':
                        handleVoiceCommand(event.data.text);
                        break;
                    case 'text_command':
                        handleTextCommand(event.data.text);
                        break;
                    case 'bot_ready':
                        showVoiceStatus('–ì–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã');
                        break;
                }
            }
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥
        function handleVoiceCommand(text) {
            console.log('–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã:', text);
            showVoiceStatus(`–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º: "${text}"`);

            const exercise = voiceParser.parse(text);

            if (exercise) {
                addVoiceExercise(exercise);
                showVoiceStatus(`‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: ${exercise.name}`);
                showNotification(`üé§ –î–æ–±–∞–≤–ª–µ–Ω–æ –≥–æ–ª–æ—Å–æ–º: ${exercise.name} ${exercise.weight}–∫–≥ √ó ${exercise.reps}`);
            } else {
                showVoiceStatus(`‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å: "${text}"`);
                showNotification('–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∫–∞–∑–∞—Ç—å: "–∂–∏–º –ª–µ–∂–∞ 80 –∫–≥ 10 —Ä–∞–∑"');
            }

            // –°–∫—Ä—ã—Ç—å —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                hideVoiceStatus();
            }, 5000);
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥
        function handleTextCommand(text) {
            console.log('–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã:', text);
            handleVoiceCommand(text); // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ –ø–∞—Ä—Å–µ—Ä
        }

        // –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–º
        function addVoiceExercise(exerciseData) {
            const exercise = {
                id: Date.now() + Math.random(),
                name: exerciseData.name,
                sets: exerciseData.sets,
                reps: exerciseData.reps,
                weight: exerciseData.weight,
                completedSets: [],
                setData: []
            };

            // –°–æ–∑–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥—Ö–æ–¥–æ–≤
            for (let i = 0; i < exercise.sets; i++) {
                exercise.setData.push({
                    weight: exercise.weight,
                    reps: exercise.reps
                });
            }

            exercises.push(exercise);
            renderExercises();
            saveData();

            // –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –¥–ª—è –Ω–æ–≤–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
            setTimeout(() => {
                const newItem = document.querySelector('.exercise-item:last-child');
                if (newItem) {
                    newItem.classList.add('new-added');
                }
            }, 100);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥
        function showVoiceStatus(message) {
            const status = document.getElementById('voiceStatus');
            status.textContent = message;
            status.classList.add('active');
        }

        // –°–∫—Ä—ã—Ç—å —Å—Ç–∞—Ç—É—Å –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥
        function hideVoiceStatus() {
            const status = document.getElementById('voiceStatus');
            status.classList.remove('active');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            updateCurrentDate();
            loadData();
            updateStats();
            renderCalendar();
            updateProgressStats();

            // –ü–æ–∫–∞–∑–∞—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –≥–æ–ª–æ—Å–æ–≤—ã–º –∫–æ–º–∞–Ω–¥–∞–º
            setTimeout(() => {
                showVoiceStatus('–ì–æ—Ç–æ–≤ –∫ –≥–æ–ª–æ—Å–æ–≤—ã–º –∫–æ–º–∞–Ω–¥–∞–º');
                setTimeout(hideVoiceStatus, 3000);
            }, 1000);
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞—Ç—É
        function updateCurrentDate() {
            const now = new Date();
            const months = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'];
            document.getElementById('currentDate').textContent = 
                `${months[now.getMonth()]} ${now.getFullYear()}`;
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
        function loadData() {
            const savedExercises = localStorage.getItem('currentExercises');
            const savedWorkoutState = localStorage.getItem('workoutActive');

            if (savedExercises) {
                exercises = JSON.parse(savedExercises);
                renderExercises();
            }

            if (savedWorkoutState === 'true') {
                isWorkoutActive = true;
                const savedStartTime = localStorage.getItem('workoutStartTime');
                if (savedStartTime) {
                    workoutStartTime = new Date(savedStartTime);
                }
                updateWorkoutUI();
                startTimer();
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
        function saveData() {
            localStorage.setItem('currentExercises', JSON.stringify(exercises));
            localStorage.setItem('workoutActive', isWorkoutActive);
            if (workoutStartTime) {
                localStorage.setItem('workoutStartTime', workoutStartTime.toISOString());
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–æ–≤
        function switchView(view) {
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            event.target.closest('.nav-item').classList.add('active');

            document.getElementById('mainContent').style.display = view === 'main' ? 'block' : 'none';
            document.getElementById('calendarContent').style.display = view === 'calendar' ? 'block' : 'none';
            document.getElementById('progressContent').style.display = view === 'progress' ? 'block' : 'none';

            if (view === 'calendar') renderCalendar();
            if (view === 'progress') updateProgressStats();
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
        function toggleWorkout() {
            if (isWorkoutActive) {
                if (confirm('–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É?')) {
                    finishWorkout();
                }
            } else {
                startWorkout();
            }
        }

        // –ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
        function startWorkout() {
            if (exercises.length === 0) {
                showNotification('–î–æ–±–∞–≤—å—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏');
                return;
            }

            isWorkoutActive = true;
            workoutStartTime = new Date();
            updateWorkoutUI();
            startTimer();
            saveData();
            showNotification('üèãÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –Ω–∞—á–∞—Ç–∞!');
        }

        // –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
        function finishWorkout() {
            isWorkoutActive = false;

            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }

            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∏—Å—Ç–æ—Ä–∏—é
            const dateKey = new Date().toISOString().split('T')[0];
            if (!workoutHistory[dateKey]) {
                workoutHistory[dateKey] = [];
            }

            workoutHistory[dateKey].push({
                time: new Date().toISOString(),
                exercises: exercises.map(ex => ({
                    name: ex.name,
                    sets: ex.sets,
                    completedSets: ex.completedSets ? ex.completedSets.length : 0
                }))
            });

            localStorage.setItem('workoutHistory', JSON.stringify(workoutHistory));

            // –û—á–∏—Å—Ç–∏—Ç—å
            exercises = [];
            workoutStartTime = null;
            localStorage.removeItem('currentExercises');
            localStorage.removeItem('workoutActive');
            localStorage.removeItem('workoutStartTime');

            updateWorkoutUI();
            updateStats();
            renderExercises();
            showNotification('üéâ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
        }

        // –û–±–Ω–æ–≤–∏—Ç—å UI —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function updateWorkoutUI() {
            const btn = document.getElementById('startBtn');
            const timer = document.getElementById('workoutTimer');
            const progress = document.getElementById('workoutProgress');

            if (isWorkoutActive) {
                btn.innerHTML = '<span class="material-symbols-outlined icon-only">stop</span>–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É';
                btn.className = 'btn btn-danger';
                timer.classList.add('active');
                progress.classList.add('active');
            } else {
                btn.innerHTML = '<span class="material-symbols-outlined icon-only">play_arrow</span>–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É';
                btn.className = 'btn';
                timer.classList.remove('active');
                progress.classList.remove('active');
            }
        }

        // –¢–∞–π–º–µ—Ä
        function startTimer() {
            timerInterval = setInterval(() => {
                if (workoutStartTime) {
                    const elapsed = Date.now() - workoutStartTime.getTime();
                    const minutes = Math.floor(elapsed / 60000);
                    const seconds = Math.floor((elapsed % 60000) / 1000);
                    document.getElementById('timerDisplay').textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                }
            }, 1000);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        function showAddExercise() {
            document.getElementById('addExerciseModal').classList.add('active');
        }

        // –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
        function addExercise() {
            const name = document.getElementById('exerciseName').value.trim();
            const sets = parseInt(document.getElementById('exerciseSets').value);
            const reps = parseInt(document.getElementById('exerciseReps').value);
            const weight = parseFloat(document.getElementById('exerciseWeight').value);

            if (!name) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è');
                return;
            }

            exercises.push({
                id: Date.now(),
                name,
                sets,
                reps,
                weight,
                completedSets: [],
                setData: []
            });

            for (let i = 0; i < sets; i++) {
                exercises[exercises.length - 1].setData.push({weight, reps});
            }

            renderExercises();
            saveData();
            closeModal('addExerciseModal');

            document.getElementById('exerciseName').value = '';
            document.getElementById('exerciseSets').value = '3';
            document.getElementById('exerciseReps').value = '10';
            document.getElementById('exerciseWeight').value = '20';

            showNotification(`–î–æ–±–∞–≤–ª–µ–Ω–æ: ${name}`);
        }

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        function renderExercises() {
            const container = document.getElementById('exercisesList');

            if (exercises.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <span class="material-symbols-outlined">edit_note</span>
                        </div>
                        <div style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #475569;">
                            –ù–∞—á–Ω–∏—Ç–µ –Ω–æ–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
                        </div>
                        <div style="font-size: 12px; color: #64748b;">
                            –î–æ–±–∞–≤—å—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≥–æ–ª–æ—Å–æ–º –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏
                        </div>
                    </div>
                `;
                return;
            }

            container.innerHTML = exercises.map(ex => `
                <div class="exercise-item ${isWorkoutActive ? 'active' : ''}">
                    <div class="exercise-header">
                        <div class="exercise-name">${ex.name}</div>
                        <div class="exercise-controls">
                            <div class="control-btn add" onclick="addSet(${ex.id})">
                                <span class="material-symbols-outlined icon-only">add</span>
                            </div>
                            <div class="control-btn delete" onclick="removeExercise(${ex.id})">
                                <span class="material-symbols-outlined icon-only">delete</span>
                            </div>
                        </div>
                    </div>

                    <div class="sets-header">
                        <div>#</div>
                        <div>–∫–≥</div>
                        <div>—Ä–∞–∑</div>
                        <div>‚úì</div>
                    </div>

                    ${ex.setData.map((set, i) => `
                        <div class="set-row">
                            <div class="set-number">${i + 1}</div>
                            <input type="number" class="set-input" value="${set.weight}" 
                                   onchange="updateSetData(${ex.id}, ${i}, 'weight', this.value)">
                            <input type="number" class="set-input" value="${set.reps}"
                                   onchange="updateSetData(${ex.id}, ${i}, 'reps', this.value)">
                            <div class="check-circle ${ex.completedSets.includes(i) ? 'checked' : ''}" 
                                 onclick="toggleSet(${ex.id}, ${i})"></div>
                        </div>
                    `).join('')}
                </div>
            `).join('');

            updateProgress();
        }

        // –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥
        function addSet(exerciseId) {
            const exercise = exercises.find(ex => ex.id === exerciseId);
            if (exercise) {
                const lastSet = exercise.setData[exercise.setData.length - 1];
                exercise.setData.push({
                    weight: lastSet ? lastSet.weight : exercise.weight,
                    reps: lastSet ? lastSet.reps : exercise.reps
                });
                exercise.sets++;
                renderExercises();
                saveData();
            }
        }

        // –£–¥–∞–ª–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
        function removeExercise(exerciseId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ?')) {
                exercises = exercises.filter(ex => ex.id !== exerciseId);
                renderExercises();
                saveData();
            }
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥–∞
        function updateSetData(exerciseId, setIndex, field, value) {
            const exercise = exercises.find(ex => ex.id === exerciseId);
            if (exercise && exercise.setData[setIndex]) {
                exercise.setData[setIndex][field] = parseFloat(value) || 0;
                saveData();
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –ø–æ–¥—Ö–æ–¥
        function toggleSet(exerciseId, setIndex) {
            const exercise = exercises.find(ex => ex.id === exerciseId);
            if (exercise) {
                const idx = exercise.completedSets.indexOf(setIndex);
                if (idx > -1) {
                    exercise.completedSets.splice(idx, 1);
                } else {
                    exercise.completedSets.push(setIndex);
                }
                renderExercises();
                saveData();
            }
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
        function updateProgress() {
            const totalSets = exercises.reduce((sum, ex) => sum + ex.setData.length, 0);
            const completedSets = exercises.reduce((sum, ex) => sum + ex.completedSets.length, 0);
            const progress = totalSets > 0 ? (completedSets / totalSets) * 100 : 0;

            document.getElementById('progressText').textContent = 
                `–í—ã–ø–æ–ª–Ω–µ–Ω–æ: ${completedSets} –∏–∑ ${totalSets} –ø–æ–¥—Ö–æ–¥–æ–≤`;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —à–∞–±–ª–æ–Ω—ã
        function showTemplates() {
            renderTemplatesList();
            document.getElementById('templatesModal').classList.add('active');
        }

        // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤
        function renderTemplatesList() {
            const container = document.getElementById('templatesList');
            container.innerHTML = defaultTemplates.map(template => `
                <div class="template-item" onclick="loadTemplate('${template.id}')">
                    <div class="template-name">
                        <span class="material-symbols-outlined icon">${template.icon}</span>
                        ${template.name}
                    </div>
                    <div class="template-exercises">
                        ${template.exercises.map(ex => ex.name).join(', ')}
                    </div>
                </div>
            `).join('');

            const customContainer = document.getElementById('customTemplatesList');
            if (customTemplates.length === 0) {
                customContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #94a3b8; font-size: 12px;">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤</div>';
            } else {
                customContainer.innerHTML = customTemplates.map((template, idx) => `
                    <div class="template-item custom" onclick="loadCustomTemplate(${idx})">
                        <div class="template-name">
                            <span class="material-symbols-outlined icon">star</span>
                            ${template.name}
                        </div>
                        <div class="template-exercises">
                            ${template.exercises.map(ex => ex.name).join(', ')}
                        </div>
                    </div>
                `).join('');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —à–∞–±–ª–æ–Ω
        function loadTemplate(templateId) {
            const template = defaultTemplates.find(t => t.id === templateId);
            if (template) {
                template.exercises.forEach(ex => {
                    exercises.push({
                        id: Date.now() + Math.random(),
                        name: ex.name,
                        sets: ex.sets,
                        reps: ex.reps,
                        weight: ex.weight,
                        completedSets: [],
                        setData: Array(ex.sets).fill().map(() => ({weight: ex.weight, reps: ex.reps}))
                    });
                });
                renderExercises();
                saveData();
                closeModal('templatesModal');
                showNotification(`–ó–∞–≥—Ä—É–∂–µ–Ω —à–∞–±–ª–æ–Ω: ${template.name}`);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —à–∞–±–ª–æ–Ω
        function loadCustomTemplate(index) {
            const template = customTemplates[index];
            if (template) {
                template.exercises.forEach(ex => {
                    exercises.push({
                        id: Date.now() + Math.random(),
                        name: ex.name,
                        sets: ex.sets,
                        reps: ex.reps,
                        weight: ex.weight,
                        completedSets: [],
                        setData: Array(ex.sets).fill().map(() => ({weight: ex.weight, reps: ex.reps}))
                    });
                });
                renderExercises();
                saveData();
                closeModal('templatesModal');
                showNotification(`–ó–∞–≥—Ä—É–∂–µ–Ω —à–∞–±–ª–æ–Ω: ${template.name}`);
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
        function showSaveTemplate() {
            if (exercises.length === 0) {
                showNotification('–î–æ–±–∞–≤—å—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —à–∞–±–ª–æ–Ω–∞');
                return;
            }
            closeModal('templatesModal');
            document.getElementById('saveTemplateModal').classList.add('active');
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —à–∞–±–ª–æ–Ω
        function saveCustomTemplate() {
            const name = document.getElementById('templateName').value.trim();
            if (!name) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞');
                return;
            }

            customTemplates.push({
                name,
                exercises: exercises.map(ex => ({
                    name: ex.name,
                    sets: ex.sets,
                    reps: ex.reps,
                    weight: ex.weight
                }))
            });

            localStorage.setItem('customTemplates', JSON.stringify(customTemplates));
            closeModal('saveTemplateModal');
            document.getElementById('templateName').value = '';
            showNotification(`–®–∞–±–ª–æ–Ω "${name}" —Å–æ—Ö—Ä–∞–Ω–µ–Ω!`);
        }

        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        function updateStats() {
            const totalWorkouts = Object.keys(workoutHistory).length;
            const weekAgo = new Date();
            weekAgo.setDate(weekAgo.getDate() - 7);

            const thisWeek = Object.keys(workoutHistory).filter(date => {
                return new Date(date) >= weekAgo;
            }).length;

            document.getElementById('totalWorkouts').textContent = totalWorkouts;
            document.getElementById('thisWeekWorkouts').textContent = thisWeek;
        }

        // –ö–∞–ª–µ–Ω–¥–∞—Ä—å
        function renderCalendar() {
            const months = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'];

            document.getElementById('currentMonth').textContent = 
                `${months[currentMonth]} ${currentYear}`;

            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const today = new Date();

            let html = `
                <div class="calendar-day header">–ü–Ω</div>
                <div class="calendar-day header">–í—Ç</div>
                <div class="calendar-day header">–°—Ä</div>
                <div class="calendar-day header">–ß—Ç</div>
                <div class="calendar-day header">–ü—Ç</div>
                <div class="calendar-day header">–°–±</div>
                <div class="calendar-day header">–í—Å</div>
            `;

            const startDay = firstDay === 0 ? 6 : firstDay - 1;

            for (let i = 0; i < startDay; i++) {
                html += '<div class="calendar-day" style="opacity: 0.3;"></div>';
            }

            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const isToday = today.getDate() === day && 
                               today.getMonth() === currentMonth && 
                               today.getFullYear() === currentYear;
                const hasWorkout = workoutHistory[dateKey] && workoutHistory[dateKey].length > 0;

                let classes = 'calendar-day';
                if (isToday) classes += ' today';
                if (hasWorkout) classes += ' has-workout';

                html += `<div class="${classes}">${day}</div>`;
            }

            document.getElementById('calendar').innerHTML = html;
        }

        // –ò–∑–º–µ–Ω–∏—Ç—å –º–µ—Å—è—Ü
        function changeMonth(delta) {
            currentMonth += delta;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        }

        // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        function updateProgressStats() {
            const container = document.getElementById('progressStats');

            if (Object.keys(workoutHistory).length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">
                            <span class="material-symbols-outlined">trending_up</span>
                        </div>
                        <div style="font-size: 14px; font-weight: 600; margin-bottom: 6px; color: #475569;">
                            –ü–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
                        </div>
                        <div style="font-size: 12px; color: #64748b;">
                            –ù–∞—á–Ω–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
                        </div>
                    </div>
                `;
                return;
            }

            const totalSets = Object.values(workoutHistory).reduce((sum, workouts) => {
                return sum + workouts.reduce((wSum, w) => {
                    return wSum + w.exercises.reduce((eSum, e) => eSum + e.completedSets, 0);
                }, 0);
            }, 0);

            container.innerHTML = `
                <div class="workout-diary">
                    <div style="text-align: center;">
                        <div style="font-size: 32px; font-weight: 700; color: #059669; margin-bottom: 8px;">
                            ${totalSets}
                        </div>
                        <div style="font-size: 14px; color: #64748b;">
                            –í—Å–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–¥—Ö–æ–¥–æ–≤
                        </div>
                    </div>
                </div>
            `;
        }

        // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => notification.remove(), 3000);
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–±–ª–∞—Å—Ç–∏
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                closeModal(event.target.id);
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
